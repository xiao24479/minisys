<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script language="JavaScript" src="script/rights/index.js"></script>
<script language="JavaScript" src="/_ext/script/jquery.js"></script>
<script language="JavaScript" src="/_ext/dialog/dialog.js"></script>
<script language="JavaScript" src="/admin/assets/daterangepicker/daterangepicker.js"></script>
<script language="JavaScript" src="/admin/assets/daterangepicker/moment.js"></script> 

<link href="/_ext/dialog/dialog.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/admin/assets/daterangepicker/daterangepicker.css" media="all">
<link href="/_ext/style/css.css" rel="stylesheet" type="text/css">
<script language="javascript">


function access_list(p){
	var fame = $('#fame').val(),
		style = $('#style').val(),
		sex = $('#sex').val(),
		agetype = $('#agetype').val();

	$.ajax({
	    url:"/chat/main.php",
	    type:"get",
	    dataType:"json",
	    data:{
	    	m:"access",
	    	a:"access_list",
	    	p:p,
	    	fame:fame,
	    	style:style,
	    	sex:sex,
	    	agetype:agetype,
	    	j:1,
	    	tt:Math.random()
	    },
	    success:function(resp){
	      $("#page-wrapper").html(resp.content);
	    }
	});
}


function del(id) {
	if(confirm('确定删除?将同时删除相关的空数据表, 如果表中有数据则无法删除!')){
		$.ajax({
			url: '/chat/main.php',
			type: 'get',
			dataType: 'json',
			data:{m:"access",a:"del_robot",id:id,j:1,tt:Math.random()},
			success: function(res) {
				if(res.result == 1){
					access_list(1)
				}
				alert(res.message);
			}
		})
	}
}


function set_date(start_time){
	var day  = new Date();
	var days =day.getDate();
	days = days - 1;

	$('#'+start_time).daterangepicker({
	    ranges: {
	        '本月': [moment().subtract(+days,'days'), moment()],
	        '今天': [moment(), moment()],
	        '昨天': [moment().subtract(+1, 'days'), moment().subtract(+1, 'days')],
	        '过去一周': [moment().subtract(+6, 'days'),moment()],
	        '过去一月': [moment().subtract(+30, 'days'),moment()],
	        '过去一年': [moment().subtract(+365, 'days'),moment()]
	    }
	    
	},function(start, end,label) {
	    	//label:通过它来知道用户选择的是什么，传给后台进行相应的展示
	 		console.log(label)
		    if(label=='本月'){
		        $('#daterange-btn span').html(start.format('YYYY/MM/DD')+'-'+end.format('YYYY/MM/DD'));
		    }else if(label=='今天'){
		        $('#daterange-btn span').html(start.format('YYYY/MM/DD'));
		    }else if(label=='昨天'){
		        $('#daterange-btn span').html(start.format('YYYY/MM/DD')+'-'+end.format('YYYY/MM/DD'));
		    }else if(label=='过去一周'){
		        $('#daterange-btn span').html(start.format('YYYY/MM/DD')+'-'+end.format('YYYY/MM/DD'));
		    }else if(label=='过去一月'){
		        $('#daterange-btn span').html(start.format('YYYY/MM/DD')+'-'+end.format('YYYY/MM/DD'));
		    }else if(label=='过去一年'){
		        $('#daterange-btn span').html(start.format('YYYY/MM/DD')+'-'+end.format('YYYY/MM/DD'));
		    }
	});
}


function check_vistor(id){ 
	$.ajax({ 
	    url:"/chat/main.php",
	    type:"get",
	    dataType:"json",
		data:{m:"access",a:"check_vistor",j:1,id:id,tt:Math.random()},
	    success:function(resp){
	    	dialog('查看对话信息',resp.content,700,600);  
		 }
	});
}


function add_action(){
	var fame = $('#add_fame').val(),
		style = $('#add_style').val(),
		sex = $('#add_sex').val(),
		agetype = $('#add_agetype').val(),
		robot = $('#robot').val();
		
	$.ajax({ 
	    url:"/chat/main.php",
	    type:"get",
	    dataType:"json",
		data:{
			m:"access",
			a:"add_action",
			fame:fame,
			style:style,
			sex:sex,
			agetype:agetype,
			robot:robot,
			j:1,
			tt:Math.random()
		},
	    success:function(resp){
	    	if(resp.content == 1){
	    		$('#dialog').remove();
	    		access_list(1);
	    	}
	    	alert(resp.message);
		}
	});
}


function add_access(id){
	$.ajax({ 
	    url:"/chat/main.php",
	    type:"get",
	    dataType:"json",
		data:{m:"access",a:"add_access",j:1,id:id,tt:Math.random()},
	    success:function(resp){
	    	dialog('添加机器人',resp.content,600,600);  
		}
	});
}


function setRobot(value){
	$.ajax({ 
	    url:"/chat/main.php",
	    type:"get",
	    dataType:"json",
		data:{m:"access",a:"select_robot",style:value,j:1,tt:Math.random()},
	    success:function(resp){
	    	$('#robot').html(resp.content);
		 }
	});
}

</script>
<style type="text/css">
	.spanzz{
		float:left;margin:20px 5px 15px 15px;
	}
	.inputzz{
		width:180px;float:left;margin:15px 0;
	}
</style>
</head>
<body>
    <div class="col-md-12">
      <!--   Kitchen Sink -->
        <div class="panel panel-default">
        	<div class="panel-heading">
                <div >机器人列表<a href="javascript:add_access();" style="padding-right: 10px;float: right;color: #32C2Cd;">添加机器人</a></div>
				
				<span class="spanzz" style="margin-left:0px;">名称:</span>
				<input type="text" class="form-control inputzz" id="fame" name="fame" value="{$fame}" style="width:210px;" />
				
				<span class="spanzz">类别:</span>
				<select class="form-control inputzz" id="style" name="style">
						   <option value="">选择</option>
						   <option value="1" {if $style eq 1}selected{/if}>字典</option>
						   <option value="2" {if $style eq 2}selected{/if}>套路</option>
				</select>
				
				<span class="spanzz">性别:</span>
				<select class="form-control inputzz" id="sex" name="sex">
						   <option value="">选择</option>
						   <option value="1" {if $sex eq 1}selected{/if}>男性</option>
						   <option value="2" {if $sex eq 2}selected{/if}>女性</option>
				</select>
				
				<span class="spanzz">年龄:</span>
				<select class="form-control inputzz" id="agetype" name="agetype">
						   <option value="">选择</option>
						   <option value="1" {if $agetype eq 1}selected{/if}>青年</option>
						   <option value="2" {if $agetype eq 2}selected{/if}>中年</option>
						   <option value="3" {if $agetype eq 3}selected{/if}>老年</option>
				</select>
				
				<input  onClick="javascript:access_list(1);" type="submit" style="margin:15px;" class="btn btn-default" value="查询数据">
				
			</div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
						<thead>
							<tr>
							    <th class="thh" width="4%"><strong>ID</strong></th>
							    <th class="thh" width="5%"><strong>名称</strong></th>
								<th class="thh" width="5%"><strong>类别</strong></th>
								<th class="thh" width="5%"><strong>性别</strong></th>
								<th class="thh" width="5%"><strong>年龄</strong></th>
								<th class="thh" width="20%"><strong>接口</strong></th>
								<th class="thh" width="10%"><strong>创建时间</strong></th>
								<th class="thh" width="10%"><strong>操作</strong></th>
							</tr>
                        </thead>
                        <tbody id="alluser">
							{foreach from=$data item=list}
							  <tr>
							    <td class="bgr">{$list.id}</td>
							    <td class="bgr">{$list.fame}</td>
								<td class="bgr">{if $list.style eq 1}字典{elseif $list.style eq 2}套路{/if}</td>
								<td class="bgr">{if $list.sex eq 1}男性{elseif $list.sex eq 2}女性{/if}</td>
								<td class="bgr">{if $list.agetype eq 1}青年{elseif $list.agetype eq 2}中年{elseif $list.agetype eq 3}老年{/if}</td>
								<td class="bgr">{$list.interface}</td>
								<td class="bgr">{if $list.createTime}{$list.createTime|date:'Y-m-d H'}:{$list.createTime|date:'i'}:{$list.createTime|date:'s'}{else}{/if}</td>
								<td class="bgr">
									<a href="javascript:del({$list.id});">删除</a>
								</td>
							  </tr>
							 {/foreach}  
								<tr>
									<td colspan="8" style="background: white;">
										{if $data}
											{$page}
										{else}
											没有数据
										{/if}
									</td>
								</tr>                             
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
         <!-- End  Kitchen Sink -->
    </div>
</body>
</html>